#!/usr/bin/env bash
#========================================================
# mk_sw799.sh - flippy DIY script for SW799 (RK3399)
#========================================================

set -e

echo "[INFO] Enter SW799 DIY script"

#--------------------------------------------------
# ✅ 修正1: 必须改为正确的DTB绑定格式
# (删除 CUSTOMIZE_RK3399="yes" 和 DTB_FILE)
#--------------------------------------------------
CUSTOMIZE_RK3399="sw799:rk3399-bozz-sw799.dtb"

#--------------------------------------------------
# SOC / BOARD 基本信息 (可保留，但非必需)
#--------------------------------------------------
SOC="rk3399"
BOARD="sw799"

#--------------------------------------------------
# Rootfs（由 workflow 提供）
#--------------------------------------------------
if [[ -z "${OPENWRT_ARMSR}" ]]; then
    echo "[ERROR] OPENWRT_ARMSR not set"
    exit 1
fi

echo "[INFO] Using rootfs: ${OPENWRT_ARMSR}"

#--------------------------------------------------
# 关键：交还给 flippy / packit
#--------------------------------------------------
packit_build

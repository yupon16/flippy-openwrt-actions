name: Build OpenWrt for RK3399 SW799 (Author-grade)

on:
  workflow_dispatch:
    inputs:
      kernel_series:
        description: "Kernel series"
        required: true
        default: "6.1"
        type: choice
        options:
          - "6.1"
          - "6.12"

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      # ===== packit 工作模式（必须）=====
      mode: openwrt

      # ===== SoC / 架构声明 =====
      OPENWRT_ARMSR: rk3399

      # ===== 板级唯一声明（A 路线核心）=====
      OPENWRT_BOARD: sw799
      OPENWRT_DTB: rk3399-bozz-sw799.dtb

      # ===== 内核版本选择 =====
      KERNEL_VERSION: ${{ inputs.kernel_series }}

      # ===== rootfs =====
      OPENWRT_ROOTFS_REPO: ophub/OpenWrt_armv8_rootfs

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Build OpenWrt image for SW799
        uses: ophub/flippy-openwrt-actions@main
        with:
          mode: ${{ env.mode }}
